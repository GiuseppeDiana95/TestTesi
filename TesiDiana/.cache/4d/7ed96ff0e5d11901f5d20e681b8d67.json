{"id":"../node_modules/react-mosaic-component/lib/MosaicWindow.js","dependencies":[{"name":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js.map","includedInParent":true,"mtime":1695993896596},{"name":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/src/MosaicWindow.tsx","includedInParent":true,"mtime":1695993900130},{"name":"/home/giuseppe/Scrivania/TesiDiana/package.json","includedInParent":true,"mtime":1698312122672},{"name":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/package.json","includedInParent":true,"mtime":1695993894381},{"name":"classnames","loc":{"line":31,"column":43,"index":1386},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/classnames/index.js"},{"name":"lodash/defer","loc":{"line":32,"column":38,"index":1440},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/lodash/defer.js"},{"name":"lodash/dropRight","loc":{"line":33,"column":42,"index":1500},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/lodash/dropRight.js"},{"name":"lodash/isEmpty","loc":{"line":34,"column":40,"index":1562},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/lodash/isEmpty.js"},{"name":"lodash/isEqual","loc":{"line":35,"column":40,"index":1622},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/lodash/isEqual.js"},{"name":"lodash/values","loc":{"line":36,"column":39,"index":1681},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/lodash/values.js"},{"name":"react","loc":{"line":37,"column":38,"index":1738},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react/index.js"},{"name":"react-dnd","loc":{"line":38,"column":26,"index":1775},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-dnd/dist/esm/index.js"},{"name":"./buttons/defaultToolbarControls","loc":{"line":39,"column":39,"index":1828},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/buttons/defaultToolbarControls.js"},{"name":"./buttons/Separator","loc":{"line":40,"column":26,"index":1891},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/buttons/Separator.js"},{"name":"./contextTypes","loc":{"line":41,"column":29,"index":1944},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/contextTypes.js"},{"name":"./internalTypes","loc":{"line":42,"column":30,"index":1993},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/internalTypes.js"},{"name":"./MosaicDropTarget","loc":{"line":43,"column":33,"index":2046},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicDropTarget.js"},{"name":"./types","loc":{"line":44,"column":22,"index":2091},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/types.js"},{"name":"./util/mosaicUpdates","loc":{"line":45,"column":30,"index":2133},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/util/mosaicUpdates.js"},{"name":"./util/mosaicUtilities","loc":{"line":46,"column":32,"index":2190},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/util/mosaicUtilities.js"},{"name":"./util/OptionalBlueprint","loc":{"line":47,"column":34,"index":2251},"parent":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/MosaicWindow.js","resolved":"/home/giuseppe/Scrivania/TesiDiana/node_modules/react-mosaic-component/lib/util/OptionalBlueprint.js"}],"generated":{"js":"\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MosaicWindow = exports.SourceDropConnectedInternalMosaicWindow = exports.SourceConnectedInternalMosaicWindow = exports.InternalMosaicWindow = void 0;\nvar classnames_1 = __importDefault(require(\"classnames\"));\nvar defer_1 = __importDefault(require(\"lodash/defer\"));\nvar dropRight_1 = __importDefault(require(\"lodash/dropRight\"));\nvar isEmpty_1 = __importDefault(require(\"lodash/isEmpty\"));\nvar isEqual_1 = __importDefault(require(\"lodash/isEqual\"));\nvar values_1 = __importDefault(require(\"lodash/values\"));\nvar react_1 = __importDefault(require(\"react\"));\nvar react_dnd_1 = require(\"react-dnd\");\nvar defaultToolbarControls_1 = require(\"./buttons/defaultToolbarControls\");\nvar Separator_1 = require(\"./buttons/Separator\");\nvar contextTypes_1 = require(\"./contextTypes\");\nvar internalTypes_1 = require(\"./internalTypes\");\nvar MosaicDropTarget_1 = require(\"./MosaicDropTarget\");\nvar types_1 = require(\"./types\");\nvar mosaicUpdates_1 = require(\"./util/mosaicUpdates\");\nvar mosaicUtilities_1 = require(\"./util/mosaicUtilities\");\nvar OptionalBlueprint_1 = require(\"./util/OptionalBlueprint\");\nvar InternalMosaicWindow = /** @class */ (function (_super) {\n    __extends(InternalMosaicWindow, _super);\n    function InternalMosaicWindow() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            additionalControlsOpen: false,\n        };\n        _this.rootElement = null;\n        _this.renderDropTarget = function (position) {\n            var path = _this.props.path;\n            return react_1.default.createElement(MosaicDropTarget_1.MosaicDropTarget, { position: position, path: path, key: position });\n        };\n        _this.split = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            _this.checkCreateNode();\n            var _a = _this.props, createNode = _a.createNode, path = _a.path;\n            var mosaicActions = _this.context.mosaicActions;\n            var root = mosaicActions.getRoot();\n            var direction = _this.rootElement.offsetWidth > _this.rootElement.offsetHeight ? 'row' : 'column';\n            return Promise.resolve(createNode.apply(void 0, args)).then(function (second) {\n                return mosaicActions.replaceWith(path, {\n                    direction: direction,\n                    second: second,\n                    first: mosaicUtilities_1.getAndAssertNodeAtPathExists(root, path),\n                });\n            });\n        };\n        _this.swap = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            _this.checkCreateNode();\n            var mosaicActions = _this.context.mosaicActions;\n            var _a = _this.props, createNode = _a.createNode, path = _a.path;\n            return Promise.resolve(createNode.apply(void 0, args)).then(function (node) { return mosaicActions.replaceWith(path, node); });\n        };\n        _this.setAdditionalControlsOpen = function (additionalControlsOpen) {\n            _this.setState({ additionalControlsOpen: additionalControlsOpen });\n        };\n        _this.getPath = function () { return _this.props.path; };\n        _this.connectDragSource = function (connectedElements) {\n            var connectDragSource = _this.props.connectDragSource;\n            return connectDragSource(connectedElements);\n        };\n        _this.childContext = {\n            mosaicWindowActions: {\n                split: _this.split,\n                replaceWithNew: _this.swap,\n                setAdditionalControlsOpen: _this.setAdditionalControlsOpen,\n                getPath: _this.getPath,\n                connectDragSource: _this.connectDragSource,\n            },\n        };\n        return _this;\n    }\n    InternalMosaicWindow.prototype.render = function () {\n        var _this = this;\n        var _a = this.props, className = _a.className, isOver = _a.isOver, renderPreview = _a.renderPreview, additionalControls = _a.additionalControls, connectDropTarget = _a.connectDropTarget, connectDragPreview = _a.connectDragPreview, draggedMosaicId = _a.draggedMosaicId;\n        return (react_1.default.createElement(contextTypes_1.MosaicWindowContext.Provider, { value: this.childContext }, connectDropTarget(react_1.default.createElement(\"div\", { className: classnames_1.default('mosaic-window mosaic-drop-target', className, {\n                'drop-target-hover': isOver && draggedMosaicId === this.context.mosaicId,\n                'additional-controls-open': this.state.additionalControlsOpen,\n            }), ref: function (element) { return (_this.rootElement = element); } },\n            this.renderToolbar(),\n            react_1.default.createElement(\"div\", { className: \"mosaic-window-body\" }, this.props.children),\n            react_1.default.createElement(\"div\", { className: \"mosaic-window-body-overlay\", onClick: function () { return _this.setAdditionalControlsOpen(false); } }),\n            react_1.default.createElement(\"div\", { className: \"mosaic-window-additional-actions-bar\" }, additionalControls),\n            connectDragPreview(renderPreview(this.props)),\n            react_1.default.createElement(\"div\", { className: \"drop-target-container\" }, values_1.default(internalTypes_1.MosaicDropTargetPosition).map(this.renderDropTarget))))));\n    };\n    InternalMosaicWindow.prototype.getToolbarControls = function () {\n        var _a = this.props, toolbarControls = _a.toolbarControls, createNode = _a.createNode;\n        if (toolbarControls) {\n            return toolbarControls;\n        }\n        else if (createNode) {\n            return defaultToolbarControls_1.DEFAULT_CONTROLS_WITH_CREATION;\n        }\n        else {\n            return defaultToolbarControls_1.DEFAULT_CONTROLS_WITHOUT_CREATION;\n        }\n    };\n    InternalMosaicWindow.prototype.renderToolbar = function () {\n        var _a;\n        var _this = this;\n        var _b = this.props, title = _b.title, draggable = _b.draggable, additionalControls = _b.additionalControls, additionalControlButtonText = _b.additionalControlButtonText, path = _b.path, renderToolbar = _b.renderToolbar;\n        var additionalControlsOpen = this.state.additionalControlsOpen;\n        var toolbarControls = this.getToolbarControls();\n        var draggableAndNotRoot = draggable && path.length > 0;\n        var connectIfDraggable = draggableAndNotRoot ? this.props.connectDragSource : function (el) { return el; };\n        if (renderToolbar) {\n            var connectedToolbar = connectIfDraggable(renderToolbar(this.props, draggable));\n            return (react_1.default.createElement(\"div\", { className: classnames_1.default('mosaic-window-toolbar', { draggable: draggableAndNotRoot }) }, connectedToolbar));\n        }\n        var titleDiv = connectIfDraggable(react_1.default.createElement(\"div\", { title: title, className: \"mosaic-window-title\" }, title));\n        var hasAdditionalControls = !isEmpty_1.default(additionalControls);\n        return (react_1.default.createElement(\"div\", { className: classnames_1.default('mosaic-window-toolbar', { draggable: draggableAndNotRoot }) },\n            titleDiv,\n            react_1.default.createElement(\"div\", { className: classnames_1.default('mosaic-window-controls', OptionalBlueprint_1.OptionalBlueprint.getClasses('BUTTON_GROUP')) },\n                hasAdditionalControls && (react_1.default.createElement(\"button\", { onClick: function () { return _this.setAdditionalControlsOpen(!additionalControlsOpen); }, className: classnames_1.default(OptionalBlueprint_1.OptionalBlueprint.getClasses('BUTTON', 'MINIMAL'), OptionalBlueprint_1.OptionalBlueprint.getIconClass('MORE'), (_a = {},\n                        _a[OptionalBlueprint_1.OptionalBlueprint.getClasses('ACTIVE')] = additionalControlsOpen,\n                        _a)) },\n                    react_1.default.createElement(\"span\", { className: \"control-text\" }, additionalControlButtonText))),\n                hasAdditionalControls && react_1.default.createElement(Separator_1.Separator, null),\n                toolbarControls)));\n    };\n    InternalMosaicWindow.prototype.checkCreateNode = function () {\n        if (this.props.createNode == null) {\n            throw new Error('Operation invalid unless `createNode` is defined');\n        }\n    };\n    InternalMosaicWindow.defaultProps = {\n        additionalControlButtonText: 'More',\n        draggable: true,\n        renderPreview: function (_a) {\n            var title = _a.title;\n            return (react_1.default.createElement(\"div\", { className: \"mosaic-preview\" },\n                react_1.default.createElement(\"div\", { className: \"mosaic-window-toolbar\" },\n                    react_1.default.createElement(\"div\", { className: \"mosaic-window-title\" }, title)),\n                react_1.default.createElement(\"div\", { className: \"mosaic-window-body\" },\n                    react_1.default.createElement(\"h4\", null, title),\n                    react_1.default.createElement(OptionalBlueprint_1.OptionalBlueprint.Icon, { iconSize: 72, icon: \"application\" }))));\n        },\n        renderToolbar: null,\n    };\n    InternalMosaicWindow.contextType = contextTypes_1.MosaicContext;\n    return InternalMosaicWindow;\n}(react_1.default.Component));\nexports.InternalMosaicWindow = InternalMosaicWindow;\nvar dragSource = {\n    beginDrag: function (props, _monitor, component) {\n        if (props.onDragStart) {\n            props.onDragStart();\n        }\n        // TODO: Actually just delete instead of hiding\n        // The defer is necessary as the element must be present on start for HTML DnD to not cry\n        var hideTimer = defer_1.default(function () { return component.context.mosaicActions.hide(component.props.path); });\n        return {\n            mosaicId: component.context.mosaicId,\n            hideTimer: hideTimer,\n        };\n    },\n    endDrag: function (props, monitor, component) {\n        var hideTimer = monitor.getItem().hideTimer;\n        // If the hide call hasn't happened yet, cancel it\n        window.clearTimeout(hideTimer);\n        var ownPath = component.props.path;\n        var dropResult = (monitor.getDropResult() || {});\n        var mosaicActions = component.context.mosaicActions;\n        var position = dropResult.position, destinationPath = dropResult.path;\n        if (position != null && destinationPath != null && !isEqual_1.default(destinationPath, ownPath)) {\n            mosaicActions.updateTree(mosaicUpdates_1.createDragToUpdates(mosaicActions.getRoot(), ownPath, destinationPath, position));\n            if (props.onDragEnd) {\n                props.onDragEnd('drop');\n            }\n        }\n        else {\n            // TODO: restore node from captured state\n            mosaicActions.updateTree([\n                {\n                    path: dropRight_1.default(ownPath),\n                    spec: {\n                        splitPercentage: {\n                            $set: null,\n                        },\n                    },\n                },\n            ]);\n            if (props.onDragEnd) {\n                props.onDragEnd('reset');\n            }\n        }\n    },\n};\nvar dropTarget = {};\n// Each step exported here just to keep react-hot-loader happy\nexports.SourceConnectedInternalMosaicWindow = react_dnd_1.DragSource(types_1.MosaicDragType.WINDOW, dragSource, function (connect, _monitor) { return ({\n    connectDragSource: connect.dragSource(),\n    connectDragPreview: connect.dragPreview(),\n}); })(InternalMosaicWindow);\nexports.SourceDropConnectedInternalMosaicWindow = react_dnd_1.DropTarget(types_1.MosaicDragType.WINDOW, dropTarget, function (connect, monitor) { return ({\n    connectDropTarget: connect.dropTarget(),\n    isOver: monitor.isOver(),\n    draggedMosaicId: (monitor.getItem() || {}).mosaicId,\n}); })(exports.SourceConnectedInternalMosaicWindow);\nvar MosaicWindow = /** @class */ (function (_super) {\n    __extends(MosaicWindow, _super);\n    function MosaicWindow() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    MosaicWindow.prototype.render = function () {\n        return react_1.default.createElement(exports.SourceDropConnectedInternalMosaicWindow, __assign({}, this.props));\n    };\n    return MosaicWindow;\n}(react_1.default.PureComponent));\nexports.MosaicWindow = MosaicWindow;\n"},"sourceMaps":{"js":{"version":3,"file":"MosaicWindow.js","sourceRoot":"","sources":["../src/MosaicWindow.tsx"],"names":[],"mappings":"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","sourcesContent":["import classNames from 'classnames';\nimport defer from 'lodash/defer';\nimport dropRight from 'lodash/dropRight';\nimport isEmpty from 'lodash/isEmpty';\nimport isEqual from 'lodash/isEqual';\nimport values from 'lodash/values';\nimport React from 'react';\nimport {\n  ConnectDragPreview,\n  ConnectDragSource,\n  ConnectDropTarget,\n  DragSource,\n  DragSourceMonitor,\n  DropTarget,\n} from 'react-dnd';\n\nimport { DEFAULT_CONTROLS_WITHOUT_CREATION, DEFAULT_CONTROLS_WITH_CREATION } from './buttons/defaultToolbarControls';\nimport { Separator } from './buttons/Separator';\nimport { MosaicContext, MosaicWindowContext } from './contextTypes';\nimport { MosaicDragItem, MosaicDropData, MosaicDropTargetPosition } from './internalTypes';\nimport { MosaicDropTarget } from './MosaicDropTarget';\nimport { CreateNode, MosaicBranch, MosaicDirection, MosaicDragType, MosaicKey } from './types';\nimport { createDragToUpdates } from './util/mosaicUpdates';\nimport { getAndAssertNodeAtPathExists } from './util/mosaicUtilities';\nimport { OptionalBlueprint } from './util/OptionalBlueprint';\n\nexport interface MosaicWindowProps<T extends MosaicKey> {\n  title: string;\n  path: MosaicBranch[];\n  className?: string;\n  toolbarControls?: React.ReactNode;\n  additionalControls?: React.ReactNode;\n  additionalControlButtonText?: string;\n  draggable?: boolean;\n  createNode?: CreateNode<T>;\n  renderPreview?: (props: MosaicWindowProps<T>) => JSX.Element;\n  renderToolbar?: ((props: MosaicWindowProps<T>, draggable: boolean | undefined) => JSX.Element) | null;\n  onDragStart?: () => void;\n  onDragEnd?: (type: 'drop' | 'reset') => void;\n}\n\nexport interface InternalDragSourceProps {\n  connectDragSource: ConnectDragSource;\n  connectDragPreview: ConnectDragPreview;\n}\n\nexport interface InternalDropTargetProps {\n  connectDropTarget: ConnectDropTarget;\n  isOver: boolean;\n  draggedMosaicId: string | undefined;\n}\n\nexport type InternalMosaicWindowProps<T extends MosaicKey> = MosaicWindowProps<T> &\n  InternalDropTargetProps &\n  InternalDragSourceProps;\n\nexport interface InternalMosaicWindowState {\n  additionalControlsOpen: boolean;\n}\n\nexport class InternalMosaicWindow<T extends MosaicKey> extends React.Component<\n  InternalMosaicWindowProps<T>,\n  InternalMosaicWindowState\n> {\n  static defaultProps: Partial<InternalMosaicWindowProps<any>> = {\n    additionalControlButtonText: 'More',\n    draggable: true,\n    renderPreview: ({ title }) => (\n      <div className=\"mosaic-preview\">\n        <div className=\"mosaic-window-toolbar\">\n          <div className=\"mosaic-window-title\">{title}</div>\n        </div>\n        <div className=\"mosaic-window-body\">\n          <h4>{title}</h4>\n          <OptionalBlueprint.Icon iconSize={72} icon=\"application\" />\n        </div>\n      </div>\n    ),\n    renderToolbar: null,\n  };\n  static contextType = MosaicContext;\n  context!: MosaicContext<T>;\n\n  state: InternalMosaicWindowState = {\n    additionalControlsOpen: false,\n  };\n\n  private rootElement: HTMLElement | null = null;\n\n  render() {\n    const {\n      className,\n      isOver,\n      renderPreview,\n      additionalControls,\n      connectDropTarget,\n      connectDragPreview,\n      draggedMosaicId,\n    } = this.props;\n\n    return (\n      <MosaicWindowContext.Provider value={this.childContext}>\n        {connectDropTarget(\n          <div\n            className={classNames('mosaic-window mosaic-drop-target', className, {\n              'drop-target-hover': isOver && draggedMosaicId === this.context.mosaicId,\n              'additional-controls-open': this.state.additionalControlsOpen,\n            })}\n            ref={(element) => (this.rootElement = element)}\n          >\n            {this.renderToolbar()}\n            <div className=\"mosaic-window-body\">{this.props.children!}</div>\n            <div className=\"mosaic-window-body-overlay\" onClick={() => this.setAdditionalControlsOpen(false)} />\n            <div className=\"mosaic-window-additional-actions-bar\">{additionalControls}</div>\n            {connectDragPreview(renderPreview!(this.props))}\n            <div className=\"drop-target-container\">\n              {values<MosaicDropTargetPosition>(MosaicDropTargetPosition).map(this.renderDropTarget)}\n            </div>\n          </div>,\n        )}\n      </MosaicWindowContext.Provider>\n    );\n  }\n\n  private getToolbarControls() {\n    const { toolbarControls, createNode } = this.props;\n    if (toolbarControls) {\n      return toolbarControls;\n    } else if (createNode) {\n      return DEFAULT_CONTROLS_WITH_CREATION;\n    } else {\n      return DEFAULT_CONTROLS_WITHOUT_CREATION;\n    }\n  }\n\n  private renderToolbar() {\n    const { title, draggable, additionalControls, additionalControlButtonText, path, renderToolbar } = this.props;\n    const { additionalControlsOpen } = this.state;\n    const toolbarControls = this.getToolbarControls();\n    const draggableAndNotRoot = draggable && path.length > 0;\n    const connectIfDraggable = draggableAndNotRoot ? this.props.connectDragSource : (el: React.ReactElement) => el;\n\n    if (renderToolbar) {\n      const connectedToolbar = connectIfDraggable(renderToolbar(this.props, draggable)) as React.ReactElement<any>;\n      return (\n        <div className={classNames('mosaic-window-toolbar', { draggable: draggableAndNotRoot })}>\n          {connectedToolbar}\n        </div>\n      );\n    }\n\n    const titleDiv = connectIfDraggable(\n      <div title={title} className=\"mosaic-window-title\">\n        {title}\n      </div>,\n    )!;\n\n    const hasAdditionalControls = !isEmpty(additionalControls);\n\n    return (\n      <div className={classNames('mosaic-window-toolbar', { draggable: draggableAndNotRoot })}>\n        {titleDiv}\n        <div className={classNames('mosaic-window-controls', OptionalBlueprint.getClasses('BUTTON_GROUP'))}>\n          {hasAdditionalControls && (\n            <button\n              onClick={() => this.setAdditionalControlsOpen(!additionalControlsOpen)}\n              className={classNames(\n                OptionalBlueprint.getClasses('BUTTON', 'MINIMAL'),\n                OptionalBlueprint.getIconClass('MORE'),\n                {\n                  [OptionalBlueprint.getClasses('ACTIVE')]: additionalControlsOpen,\n                },\n              )}\n            >\n              <span className=\"control-text\">{additionalControlButtonText!}</span>\n            </button>\n          )}\n          {hasAdditionalControls && <Separator />}\n          {toolbarControls}\n        </div>\n      </div>\n    );\n  }\n\n  private renderDropTarget = (position: MosaicDropTargetPosition) => {\n    const { path } = this.props;\n\n    return <MosaicDropTarget position={position} path={path} key={position} />;\n  };\n\n  private checkCreateNode() {\n    if (this.props.createNode == null) {\n      throw new Error('Operation invalid unless `createNode` is defined');\n    }\n  }\n\n  private split = (...args: any[]) => {\n    this.checkCreateNode();\n    const { createNode, path } = this.props;\n    const { mosaicActions } = this.context;\n    const root = mosaicActions.getRoot();\n\n    const direction: MosaicDirection =\n      this.rootElement!.offsetWidth > this.rootElement!.offsetHeight ? 'row' : 'column';\n\n    return Promise.resolve(createNode!(...args)).then((second) =>\n      mosaicActions.replaceWith(path, {\n        direction,\n        second,\n        first: getAndAssertNodeAtPathExists(root, path),\n      }),\n    );\n  };\n\n  private swap = (...args: any[]) => {\n    this.checkCreateNode();\n    const { mosaicActions } = this.context;\n    const { createNode, path } = this.props;\n    return Promise.resolve(createNode!(...args)).then((node) => mosaicActions.replaceWith(path, node));\n  };\n\n  private setAdditionalControlsOpen = (additionalControlsOpen: boolean) => {\n    this.setState({ additionalControlsOpen });\n  };\n\n  private getPath = () => this.props.path;\n\n  private connectDragSource = (connectedElements: React.ReactElement<any>) => {\n    const { connectDragSource } = this.props;\n    return connectDragSource(connectedElements);\n  };\n\n  private readonly childContext: MosaicWindowContext = {\n    mosaicWindowActions: {\n      split: this.split,\n      replaceWithNew: this.swap,\n      setAdditionalControlsOpen: this.setAdditionalControlsOpen,\n      getPath: this.getPath,\n      connectDragSource: this.connectDragSource,\n    },\n  };\n}\n\nconst dragSource = {\n  beginDrag: (\n    props: InternalMosaicWindowProps<any>,\n    _monitor: DragSourceMonitor,\n    component: InternalMosaicWindow<any>,\n  ): MosaicDragItem => {\n    if (props.onDragStart) {\n      props.onDragStart();\n    }\n    // TODO: Actually just delete instead of hiding\n    // The defer is necessary as the element must be present on start for HTML DnD to not cry\n    const hideTimer = defer(() => component.context.mosaicActions.hide(component.props.path));\n    return {\n      mosaicId: component.context.mosaicId,\n      hideTimer,\n    };\n  },\n  endDrag: (\n    props: InternalMosaicWindowProps<any>,\n    monitor: DragSourceMonitor,\n    component: InternalMosaicWindow<any>,\n  ) => {\n    const { hideTimer } = monitor.getItem() as MosaicDragItem;\n    // If the hide call hasn't happened yet, cancel it\n    window.clearTimeout(hideTimer);\n\n    const ownPath = component.props.path;\n    const dropResult: MosaicDropData = (monitor.getDropResult() || {}) as MosaicDropData;\n    const { mosaicActions } = component.context;\n    const { position, path: destinationPath } = dropResult;\n    if (position != null && destinationPath != null && !isEqual(destinationPath, ownPath)) {\n      mosaicActions.updateTree(createDragToUpdates(mosaicActions.getRoot(), ownPath, destinationPath, position));\n      if (props.onDragEnd) {\n        props.onDragEnd('drop');\n      }\n    } else {\n      // TODO: restore node from captured state\n      mosaicActions.updateTree([\n        {\n          path: dropRight(ownPath),\n          spec: {\n            splitPercentage: {\n              $set: null,\n            },\n          },\n        },\n      ]);\n      if (props.onDragEnd) {\n        props.onDragEnd('reset');\n      }\n    }\n  },\n};\n\nconst dropTarget = {};\n\n// Each step exported here just to keep react-hot-loader happy\nexport const SourceConnectedInternalMosaicWindow = DragSource(\n  MosaicDragType.WINDOW,\n  dragSource,\n  (connect, _monitor): InternalDragSourceProps => ({\n    connectDragSource: connect.dragSource(),\n    connectDragPreview: connect.dragPreview(),\n  }),\n)(InternalMosaicWindow);\n\nexport const SourceDropConnectedInternalMosaicWindow = DropTarget(\n  MosaicDragType.WINDOW,\n  dropTarget,\n  (connect, monitor): InternalDropTargetProps => ({\n    connectDropTarget: connect.dropTarget(),\n    isOver: monitor.isOver(),\n    draggedMosaicId: ((monitor.getItem() || {}) as MosaicDragItem).mosaicId,\n  }),\n)(SourceConnectedInternalMosaicWindow as any);\n\nexport class MosaicWindow<T extends MosaicKey = string> extends React.PureComponent<MosaicWindowProps<T>> {\n  render() {\n    return <SourceDropConnectedInternalMosaicWindow {...(this.props as InternalMosaicWindowProps<T>)} />;\n  }\n}\n"]}},"error":null,"hash":"5a1d34f3ae86ea1993ee59102ba71c2c","cacheData":{"env":{}}}